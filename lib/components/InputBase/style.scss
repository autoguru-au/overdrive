@import '../../theme/tokens/facade';

:root {
	--global--input--status--icon--size: 24px;
	--global--input--status--icon--gap: var(--global--space--3);
}

.root {
	&.disabled {
		cursor: not-allowed;
	}
}

$active_scaling_factor: 0.7777;
$active_padding_added: var(--global--space--2); // 8

$input_height: 48px; // Hardcoded values are fixes for edge not supporting css variable inside transform
$font_size: var(--global--fontSize--4); // 16

@function calcPlaceholderTranslate($notched, $prefixed) {
	// TODO hard-coding these values is due to edge struggling width cal and variables mixed together

	/* stylelint-disable */

	@if $notched == true {
		@return translate(
			/*calc(var(--global--space--3) + #{$active_padding_added})
			 calc(-1 * (((#{$font_size}) * #{$active_scaling_factor}) / 2))*/
				(8px + 8px),
			(-1 * (16px * $active_scaling_factor)/ 2)
		);
	}

	@else if $prefixed == true {
		@return translate(
			/*var(--global--space--5)
			calc(((#{$size} - #{$font_size}) / 2))*/
				48px,
			(($input_height - 16px)/2)
		);
	}

	@else {
		@return translate(
			/*var(--global--space--5)
			calc(((#{$size} - #{$font_size}) / 2))*/
				16px,
			(($input_height - 16px)/2)
		);
	}
	/* stylelint-enable */
}

.prefix-icon {
	margin: 0 var(--global--space--3) 0 calc(var(--global--space--3) - 1px);
}

.suffix-icon {
	margin: 0 calc(var(--global--space--3) - 1px) 0 var(--global--space--3);
}

.notched-base {
	width: 100%;
	position: relative;
	padding: 0;
	transition: fill 0.2s cubic-bezier(0, 0, 0.2, 1) 0s;
	color: getColour(gray, 500);

	&.notched-base--active {
		color: getColour(blue, 500);
	}

	.disabled & {
		color: getColour(gray, 300);
	}

	.root:not(.disabled):hover & {
		color: getColour(blue, 500);
	}

	.root:not(.disabled).valid & {
		color: getColour(green, 600);
	}

	.root:not(.disabled).valid:hover & {
		color: getColour(green, 700);
	}

	.root:not(.disabled).invalid & {
		color: getColour(red, 600);
	}

	.root:not(.disabled).invalid:hover & {
		color: getColour(red, 700);
	}

	input,
	textarea,
	select {
		-webkit-appearance: none;
		appearance: none;
		outline: none;
		border: none;
		background: transparent;

		// Edge adds a clear button on inputs, this removes it.
		&::-ms-clear {
			display: none;
		}
	}

	input[type='number'] {
		&,
		&::-webkit-inner-spin-button,
		&::-webkit-outer-spin-button {
			appearance: textfield;
			margin: 0;
		}
	}

	&__placeholder {
		position: absolute;
		top: 0;
		left: 0;
		display: inline;
		margin: 0;
		padding: 0;
		color: getColour(gray, 400);
		font-size: #{$font_size};
		line-height: 1;
		white-space: nowrap;
		transform-origin: top left;
		transition: color 0.2s cubic-bezier(0, 0, 0.2, 1) 0s,
			fill 0.2s cubic-bezier(0, 0, 0.2, 1) 0s,
			transform 0.2s cubic-bezier(0, 0, 0.2, 1) 0s;
		pointer-events: none;

		.disabled & {
			color: getColour(gray, 400);
		}

		&:not(.prefixed) {
			transform: calcPlaceholderTranslate(false, false) scale(1);
		}

		.prefixed & {
			transform: calcPlaceholderTranslate(false, true) scale(1);
		}

		.notched-base--shift & {
			z-index: 2;
			transform: calcPlaceholderTranslate(true, false)
				scale(#{$active_scaling_factor});

			.root:not(.disabled):hover & {
				color: getColour(blue, 500);
			}

			.root:not(.disabled).valid & {
				color: getColour(green, 600);
			}

			.root:not(.disabled).valid:hover & {
				color: getColour(green, 700);
			}

			.root:not(.disabled).invalid & {
				color: getColour(red, 600);
			}

			.root:not(.disabled).invalid:hover & {
				color: getColour(red, 700);
			}
		}

		.root:not(.disabled).valid .notched-base--shift.notched-base--active &,
		.root:not(.disabled).valid:hover
		.notched-base--shift.notched-base--active
		& {
			color: getColour(green, 800);
		}

		.root:not(.disabled).invalid
		.notched-base--shift.notched-base--active
		&,
		.root:not(.disabled).invalid:hover
		.notched-base--shift.notched-base--active
		& {
			color: getColour(red, 800);
		}

		.notched-base--shift.notched-base--active & {
			color: getColour(blue, 500);
		}
	}

	// The container per-se
	&__border {
		display: flex;
		position: absolute;
		z-index: 2;
		top: 0;
		left: 0;
		right: 0;
		width: 100%;
		height: 100%;
		text-align: left;
		pointer-events: none;
		box-shadow: 0 1px 10px 0 rgba(0, 0, 0, 0.03),
			0 4px 5px 0 rgba(0, 0, 0, 0.03), 0 2px 4px -1px rgba(0, 0, 0, 0.05);
		border-radius: var(--global--space--1);

		.disabled & {
			box-shadow: none;
		}

		&__leading,
		&__notch,
		&__trailing {
			display: inline-flex;
			border: 1px solid getColour(gray, 300);
			transition: border-color 0.2s cubic-bezier(0, 0, 0.2, 1) 0s;
			pointer-events: none;

			.disabled & {
				border-color: getColour(gray, 200);
			}

			.root:not(.disabled).valid & {
				border-color: getColour(green, 600);
			}

			.root:not(.disabled).valid:hover & {
				border-color: getColour(green, 700);
			}

			.root:not(.disabled).valid .notched-base--active &,
			.root:not(.disabled).valid:hover .notched-base--active & {
				border-color: getColour(green, 800);
			}

			.root:not(.disabled).invalid & {
				border-color: getColour(red, 600);
			}

			.root:not(.disabled).invalid:hover & {
				border-color: getColour(red, 700);
			}

			.root:not(.disabled).invalid .notched-base--active &,
			.root:not(.disabled).invalid:hover .notched-base--active & {
				border-color: getColour(red, 800);
			}

			.notched-base--active &,
			.root:not(.disabled):hover & {
				border-color: getColour(blue, 500);
			}
		}

		&__leading {
			width: var(--global--space--2);
			border-radius: var(--global--space--1) 0 0 var(--global--space--1);
			border-right: none;
		}

		&__notch {
			border-width: 0;
			border-bottom-width: 1px;
			transition: width 0.15s linear,
				border-color 0.2s cubic-bezier(0, 0, 0.2, 1) 0s;
		}

		&__trailing {
			flex-grow: 1;
			border-left: none;
			border-radius: 0 var(--global--space--1) var(--global--space--1) 0;
		}
	}
}

// Applies to the native input
.input {
	position: relative;
	display: flex;
	z-index: 1;
	margin: 0;
	padding: calc(((#{$input_height} - #{$font_size}) / 2) - 3px)
		calc(var(--global--space--4) - 1px);
	grid-column-start: 1;
	grid-column-end: 4;
	width: 100%;
	height: $input_height;
	align-self: flex-end;
	line-height: 1;
	font-size: #{$font_size};
	color: getColour(gray, 900);

	.prefixed & {
		grid-column-start: 2;
		padding-left: 0;
	}

	.suffixed & {
		grid-column-end: 3;
		padding-right: 0;
	}

	@at-root textarea.input {
		$text_area_height: #{$input_height} * 2.5;

		--top-spaceing: calc(((#{$input_height} - #{$font_size}) / 2) - 3px);

		height: calc(#{$text_area_height} - var(--top-spaceing));
		min-height: calc(#{$text_area_height} - var(--top-spaceing));
		line-height: 1.2;
		resize: vertical;
		padding-top: 0;
		margin-top: var(--top-spaceing);
	}

	.disabled & {
		cursor: not-allowed;
		color: getColour(gray, 400);
		-webkit-text-fill-color: getColour(gray, 400);
		opacity: 1;
	}
}

.hint-text {
	margin-top: var(--global--space--2);
	margin-left: var(--global--space--4);
	color: getColour(gray, 400);
	transition: color 0.2s cubic-bezier(0, 0, 0.2, 1) 0s;

	.disabled & {
		color: getColour(gray, 400);
	}

	&--active,
	.root:not(.disabled):hover & {
		color: getColour(blue, 500);
	}

	.root:not(.disabled).valid & {
		color: getColour(green, 600);
	}

	.root:not(.disabled).valid:hover & {
		color: getColour(green, 700);
	}

	.root:not(.disabled).invalid & {
		color: getColour(red, 600);
	}

	.root:not(.disabled).invalid:hover & {
		color: getColour(red, 700);
	}

	&--active {
		.root:not(.disabled).invalid &,
		.root:not(.disabled).invalid:hover & {
			color: getColour(red, 800);
		}

		.root:not(.disabled).valid &,
		.root:not(.disabled).valid:hover & {
			color: getColour(green, 800);
		}
	}
}

.inputWrapper {
	display: grid;
	flex-direction: column;
	align-content: center;
	justify-content: flex-start;
	align-items: center;
	grid-template-columns: auto 1fr auto;
}
