import{r as c}from"./iframe-BHL7crnr.js";import{h as j,$ as y,i as R,j as D,d as T}from"./useFocusRing-DLYmaM22.js";import{$ as U}from"./useLabel-CK0Cge4t.js";const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...M,customError:!0,valid:!1},$={isInvalid:!1,validationDetails:M,validationErrors:[]},F=c.createContext({}),L="__formValidationState"+Date.now();function W(i){if(i[L]){let{realtimeValidation:e,displayValidation:a,updateValidation:t,resetValidation:s,commitValidation:r}=i[L];return{realtimeValidation:e,displayValidation:a,updateValidation:t,resetValidation:s,commitValidation:r}}return Q(i)}function Q(i){let{isInvalid:e,validationState:a,name:t,value:s,builtinValidation:r,validate:o,validationBehavior:n="aria"}=i;a&&(e||(e=a==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,v=c.useMemo(()=>{if(!o||s==null)return null;let d=k(o,s);return B(d)},[o,s]);r?.validationDetails.valid&&(r=void 0);let u=c.useContext(F),f=c.useMemo(()=>t?Array.isArray(t)?t.flatMap(d=>h(u[d])):h(u[t]):[],[u,t]),[P,w]=c.useState(u),[S,b]=c.useState(!1);u!==P&&(w(u),b(!1));let p=c.useMemo(()=>B(S?[]:f),[S,f]),x=c.useRef($),[V,E]=c.useState($),m=c.useRef($),A=()=>{if(!O)return;g(!1);let d=v||r||x.current;I(d,m.current)||(m.current=d,E(d))},[O,g]=c.useState(!1);return c.useEffect(A),{realtimeValidation:l||p||v||r||$,displayValidation:n==="native"?l||p||V:l||p||v||r||V,updateValidation(d){n==="aria"&&!I(V,d)?E(d):x.current=d},resetValidation(){let d=$;I(d,m.current)||(m.current=d,E(d)),n==="native"&&g(!1),b(!0)},commitValidation(){n==="native"&&g(!0),b(!0)}}}function h(i){return i?Array.isArray(i)?i:[i]:[]}function k(i,e){if(typeof i=="function"){let a=i(e);if(a&&typeof a!="boolean")return h(a)}return[]}function B(i){return i.length?{isInvalid:!0,validationErrors:i,validationDetails:C}:null}function I(i,e){return i===e?!0:!!i&&!!e&&i.isInvalid===e.isInvalid&&i.validationErrors.length===e.validationErrors.length&&i.validationErrors.every((a,t)=>a===e.validationErrors[t])&&Object.entries(i.validationDetails).every(([a,t])=>e.validationDetails[a]===t)}function X(...i){let e=new Set,a=!1,t={...M};for(let o of i){var s,r;for(let n of o.validationErrors)e.add(n);a||(a=o.isInvalid);for(let n in t)(s=t)[r=n]||(s[r]=o.validationDetails[n])}return t.valid=!a,{isInvalid:a,validationErrors:[...e],validationDetails:t}}function Z(i,e,a){let{validationBehavior:t,focus:s}=i;j(()=>{if(t==="native"&&a?.current&&!a.current.disabled){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(l),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(N(a.current))}});let r=y(()=>{e.resetValidation()}),o=y(l=>{var v;e.displayValidation.isInvalid||e.commitValidation();let u=a==null||(v=a.current)===null||v===void 0?void 0:v.form;if(!l.defaultPrevented&&a&&u&&Y(u)===a.current){var f;s?s():(f=a.current)===null||f===void 0||f.focus(),R("keyboard")}l.preventDefault()}),n=y(()=>{e.commitValidation()});c.useEffect(()=>{let l=a?.current;if(!l)return;let v=l.form;return l.addEventListener("invalid",o),l.addEventListener("change",n),v?.addEventListener("reset",r),()=>{l.removeEventListener("invalid",o),l.removeEventListener("change",n),v?.removeEventListener("reset",r)}},[a,o,n,r,t])}function q(i){let e=i.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function N(i){return{isInvalid:!i.validity.valid,validationDetails:q(i),validationErrors:i.validationMessage?[i.validationMessage]:[]}}function Y(i){for(let e=0;e<i.elements.length;e++){let a=i.elements[e];if(!a.validity.valid)return a}return null}function _(i){let{description:e,errorMessage:a,isInvalid:t,validationState:s}=i,{labelProps:r,fieldProps:o}=U(i),n=D([!!e,!!a,t,s]),l=D([!!e,!!a,t,s]);return o=T(o,{"aria-describedby":[n,l,i["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:r,fieldProps:o,descriptionProps:{id:n},errorMessageProps:{id:l}}}export{W as $,Z as a,L as b,_ as c,$ as d,X as e};
